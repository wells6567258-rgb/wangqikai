<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ±ªçªå‡¯çš„æ—¥å¸¸æ‰“å¡ç³»ç»Ÿ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.7.0/p5.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="theme.css">
    <script src="theme.js" defer></script>
    <style>
        * {
            font-family: 'Noto Sans SC', sans-serif;
        }
        
        .hero-bg {
            /* ç»Ÿä¸€ä¸ºæš–ç²‰ä¸»é¢˜ï¼Œä¸ä¸‹æ–¹å¡ç‰‡èƒŒæ™¯ä¸€è‡´ */
            background: linear-gradient(135deg, var(--sun-milk) 0%, var(--sun-pink-soft) 65%, var(--sun-pink) 100%);
            position: relative;
            overflow: hidden;
        }
        
        .card-hover {
            transition: all 0.3s ease;
        }
        
        .card-hover:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 24px rgba(0,0,0,0.15);
        }
        
        .calendar-day {
            transition: all 0.2s ease;
            cursor: pointer;
        }
        
        .calendar-day:hover {
            transform: scale(1.1);
        }
        
        .completed {
            background: #7ED321 !important;
            color: white;
        }
        
        .today {
            border: 3px solid #F5A623 !important;
            background: #FFF3CD !important;
        }
        
        .particle-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }
        
        .content-layer {
            position: relative;
            z-index: 2;
        }
        
        .achievement-badge {
            background: linear-gradient(45deg, #FFD700, #FFA500);
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .progress-ring {
            transform: rotate(-90deg);
        }
        
        .progress-ring-circle {
            transition: stroke-dashoffset 0.35s;
            transform-origin: 50% 50%;
        }
    </style>
</head>
<body class="tw-theme bg-gray-50 min-h-screen">
    <!-- èƒŒæ™¯ç²’å­åŠ¨ç”»å®¹å™¨ -->
    <div id="particle-container" class="fixed inset-0 z-0"></div>
    
    <!-- ä¸»è¦å†…å®¹ -->
    <div class="content-layer relative z-10">
        <!-- å¤´éƒ¨åŒºåŸŸ -->
        <header class="hero-bg text-white py-8">
            <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between py-3 sm:py-4">
                <div class="flex items-center space-x-3 sm:space-x-4">
                    <img id="avatar" src="resources/avatar.png" alt="å¤´åƒ" class="w-20 h-20 sm:w-24 sm:h-24 rounded-full shadow-md border-2 border-white/70">
                    <div>
                        <h1 id="site-title" class="text-xl sm:text-2xl font-bold text-gray-800 leading-tight">æ±ªçªå‡¯çš„å­¦ä¹ å¤©åœ°</h1>
                        <div class="flex flex-wrap items-center gap-2 text-xs sm:text-sm text-gray-600 mt-1">
                            <span class="px-2 py-1 bg-green-50 text-green-700 rounded-full">âœ¨ æ¯å¤©è¿›æ­¥ä¸€ç‚¹ç‚¹</span>
                            <span class="px-2 py-1 bg-blue-50 text-blue-700 rounded-full">ğŸ“… ä»Šæ—¥æ‰“å¡ï¼š<span id="today-status">æœªæ‰“å¡</span></span>
                        </div>
                        <div class="mt-2 flex items-center gap-2 text-xs sm:text-sm">
                            <button id="btn-change-avatar" class="px-2 py-1 bg-white/90 text-gray-700 rounded hover:bg-white shadow-sm">æ›´æ¢å›¾ç‰‡</button>
                            <button id="btn-edit-title" class="px-2 py-1 bg-white/90 text-gray-700 rounded hover:bg-white shadow-sm">æ›´æ”¹æ–‡å­—</button>
                            <button id="btn-reset-checkin" class="px-2 py-1 bg-white/90 text-rose-700 rounded hover:bg-white shadow-sm border border-rose-200">æ¸…ç©ºæ‰“å¡æ•°æ®</button>
                            <input id="avatar-upload" type="file" accept="image/*" class="hidden">
                        </div>
                    </div>
                </div>
                <div class="text-right">
                    <div class="text-2xl font-bold" id="current-date"></div>
                    <div class="text-blue-100">è¿ç»­æ‰“å¡ <span class="text-yellow-300 font-bold" id="streak-days">12</span> å¤©</div>
                </div>
            </div>
        </div>
        </header>

        <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
        <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 items-stretch">
                
                <!-- å·¦ä¾§ï¼šæ—¥å†åŒºåŸŸ -->
                <div class="lg:col-span-2">
                    <div class="bg-white rounded-2xl shadow-lg p-5 card-hover h-full">
                        <div class="flex items-center justify-between mb-6">
                            <h2 class="text-2xl font-bold text-gray-800">
                                <span class="mr-2">ğŸ“…</span>æ‰“å¡æ—¥å†
                            </h2>
                            <div class="flex items-center space-x-2">
                                <button id="prev-month" class="p-2 rounded-lg bg-blue-100 text-blue-600 hover:bg-blue-200 transition-colors">
                                    â†
                                </button>
                                <span id="current-month" class="text-lg font-semibold text-gray-700 min-w-32 text-center"></span>
                                <button id="next-month" class="p-2 rounded-lg bg-blue-100 text-blue-600 hover:bg-blue-200 transition-colors">
                                    â†’
                                </button>
                            </div>
                        </div>
                        
                        <!-- æ—¥å†ç½‘æ ¼ -->
                        <div class="grid grid-cols-7 gap-2 mb-4">
                            <div class="text-center text-sm font-medium text-gray-500 py-2">æ—¥</div>
                            <div class="text-center text-sm font-medium text-gray-500 py-2">ä¸€</div>
                            <div class="text-center text-sm font-medium text-gray-500 py-2">äºŒ</div>
                            <div class="text-center text-sm font-medium text-gray-500 py-2">ä¸‰</div>
                            <div class="text-center text-sm font-medium text-gray-500 py-2">å››</div>
                            <div class="text-center text-sm font-medium text-gray-500 py-2">äº”</div>
                            <div class="text-center text-sm font-medium text-gray-500 py-2">å…­</div>
                        </div>
                        
                        <div id="calendar-grid" class="grid grid-cols-7 gap-2">
                            <!-- æ—¥å†æ—¥æœŸå°†é€šè¿‡JavaScriptç”Ÿæˆ -->
                        </div>
                        
                        <!-- æ—¥å†å›¾ä¾‹ -->
                        <div class="flex items-center justify-center space-x-6 mt-6 text-sm">
                            <div class="flex items-center space-x-2">
                                <div class="w-4 h-4 bg-green-500 rounded"></div>
                                <span class="text-gray-600">å·²å®Œæˆ</span>
                            </div>
                            <div class="flex items-center space-x-2">
                                <div class="w-4 h-4 bg-gray-200 rounded"></div>
                                <span class="text-gray-600">æœªå®Œæˆ</span>
                            </div>
                            <div class="flex items-center space-x-2">
                                <div class="w-4 h-4 bg-yellow-300 rounded border-2 border-yellow-500"></div>
                                <span class="text-gray-600">ä»Šå¤©</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- å³ä¾§ï¼šä»Šæ—¥æ‰“å¡åŒºåŸŸ -->
                <div class="h-full">
                    <!-- ä»Šæ—¥ä»»åŠ¡ -->
                    <div class="bg-white rounded-2xl shadow-lg p-5 card-hover h-full flex flex-col">
                        <h2 class="text-2xl font-bold text-gray-800 mb-6">
                            <span class="mr-2">ğŸ¯</span>ä»Šæ—¥æ‰“å¡
                        </h2>
                        
                        <div class="space-y-4 flex-1" id="today-tasks">
                            <!-- ä»»åŠ¡å¡ç‰‡å°†é€šè¿‡JavaScriptç”Ÿæˆ -->
                        </div>
                    </div>

                    <!-- ç»Ÿè®¡æ¦‚è§ˆç§»è‡³åº•éƒ¨ï¼ˆæ¨ªæ’ï¼‰ -->

                    <!-- æˆå°±å±•ç¤ºæ¨¡å—å·²ç§»é™¤ -->
                </div>
            </div>

            <!-- åº•éƒ¨ï¼šå­¦ä¹ ç»Ÿè®¡ï¼ˆæ¨ªæ’ï¼‰ -->
            <div class="bg-white rounded-2xl shadow-lg p-5 card-hover mt-2">
                <h2 class="text-2xl font-bold text-gray-800 mb-4">
                    <span class="mr-2">ğŸ“Š</span>å­¦ä¹ ç»Ÿè®¡
                </h2>
                <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-6">
                    <!-- å·¦ä¾§ï¼šå®Œæˆç‡ä¸è¿›åº¦æ¡ -->
                    <div class="flex-1 min-w-[260px]">
                        <div class="flex items-center justify-between">
                            <span class="text-gray-600">æœ¬å‘¨å®Œæˆç‡</span>
                            <span class="text-2xl font-bold text-green-600" id="week-rate">85%</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-3 mt-2">
                            <div class="bg-gradient-to-r from-green-400 to-blue-500 h-3 rounded-full transition-all duration-1000" style="width: 85%" id="progress-bar"></div>
                        </div>
                    </div>
                    <!-- å³ä¾§ï¼šç»Ÿè®¡æ•°å­—æ¨ªæ’ -->
                    <div class="grid grid-cols-2 gap-6 md:w-auto">
                        <div class="text-center">
                            <div class="text-2xl font-bold text-blue-600" id="total-days">45</div>
                            <div class="text-sm text-gray-500">æ€»æ‰“å¡å¤©æ•°</div>
                        </div>
                        <div class="text-center">
                            <div class="text-2xl font-bold text-orange-600" id="total-score">1280</div>
                            <div class="text-sm text-gray-500">ç´¯è®¡ç§¯åˆ†</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- å­¦ä¹ è¶‹åŠ¿æ¨¡å—å·²ç§»é™¤ -->
        </main>
    </div>

    <!-- æ—¥æœŸè¯¦æƒ…æ¨¡æ€æ¡† -->
    <div id="date-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center">
        <div class="bg-white rounded-2xl p-6 max-w-md w-full mx-4 transform transition-all">
            <div class="flex items-center justify-between mb-4">
                <h3 class="text-xl font-bold text-gray-800" id="modal-date"></h3>
                <button id="close-modal" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
            </div>
            <div id="modal-content">
                <!-- æ—¥æœŸè¯¦æƒ…å†…å®¹å°†é€šè¿‡JavaScriptç”Ÿæˆ -->
            </div>
        </div>
    </div>

    <!-- è„šæœ¬ -->
    <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/p5@1.4.2/lib/p5.min.js"></script>
    <script src="main.js?v=2"></script>
<script>
// å¤´åƒä¸æ ‡é¢˜è‡ªå®šä¹‰
document.addEventListener('DOMContentLoaded', function(){
  var avatarEl = document.getElementById('avatar');
  var titleEl = document.getElementById('site-title');
  var uploadInput = document.getElementById('avatar-upload');
  var btnChangeAvatar = document.getElementById('btn-change-avatar');
  var btnEditTitle = document.getElementById('btn-edit-title');

  // åŠ è½½æœ¬åœ°å­˜å‚¨
  try {
    var savedAvatar = localStorage.getItem('custom_avatar');
    if(savedAvatar && avatarEl){ avatarEl.src = savedAvatar; }
    var savedTitle = localStorage.getItem('custom_title');
    if(savedTitle && titleEl){ titleEl.textContent = savedTitle; document.title = savedTitle + ' - æ—¥å¸¸æ‰“å¡ç³»ç»Ÿ'; }
  } catch(e) {}

  // æ›´æ¢å¤´åƒ
  if(btnChangeAvatar && uploadInput && avatarEl){
    btnChangeAvatar.addEventListener('click', function(){ uploadInput.click(); });
    uploadInput.addEventListener('change', function(e){
      var file = e.target.files && e.target.files[0];
      if(!file) return;
      var reader = new FileReader();
      reader.onload = function(){ var url = reader.result; avatarEl.src = url; try{ localStorage.setItem('custom_avatar', url); }catch(e){} };
      reader.readAsDataURL(file);
    });
  }

  // æ›´æ”¹æ ‡é¢˜æ–‡å­—
  if(btnEditTitle && titleEl){
    btnEditTitle.addEventListener('click', function(){
      var current = titleEl.textContent || '';
      var next = prompt('è¯·è¾“å…¥ä¸»é¡µæ ‡é¢˜ï¼š', current);
      if(next && next.trim()){
        next = next.trim();
        titleEl.textContent = next;
        document.title = next + ' - æ—¥å¸¸æ‰“å¡ç³»ç»Ÿ';
        try{ localStorage.setItem('custom_title', next); }catch(e){}
      }
    });
  }
});
</script>

<!-- å±å¹•é€‚é…å¼€å…³ï¼ˆå³ä¸Šè§’ï¼‰ -->
<div id="viewport-switcher" class="fixed top-3 right-3 z-50 select-none">
  <div class="relative">
    <button id="adapt-toggle" class="flex items-center space-x-2 px-3 py-2 bg-white/80 backdrop-blur shadow-sm border border-gray-200 rounded-full hover:bg-white">
      <span id="adapt-icon">ğŸ§­</span>
      <span id="adapt-label" class="text-sm">è‡ªé€‚åº”</span>
    </button>
    <div id="adapt-menu" class="absolute right-0 mt-2 w-44 bg-white border border-gray-200 shadow-xl rounded-xl p-2 hidden">
      <button data-adapt="auto" class="w-full text-left px-3 py-2 rounded-lg hover:bg-gray-100 flex items-center space-x-2"><span>ğŸ§­</span><span>è‡ªåŠ¨è¯†åˆ«</span></button>
      <button data-adapt="desktop" class="w-full text-left px-3 py-2 rounded-lg hover:bg-gray-100 flex items-center space-x-2"><span>ğŸ’»</span><span>ç”µè„‘ç«¯</span></button>
      <button data-adapt="tablet" class="w-full text-left px-3 py-2 rounded-lg hover:bg-gray-100 flex items-center space-x-2"><span>ğŸ“Ÿ</span><span>å¹³æ¿ç«¯</span></button>
      <button data-adapt="mobile" class="w-full text-left px-3 py-2 rounded-lg hover:bg-gray-100 flex items-center space-x-2"><span>ğŸ“±</span><span>æ‰‹æœºç«¯</span></button>
    </div>
  </div>
</div>

<style>
  html[data-adapt="desktop"] body { max-width: 1280px; margin: 0 auto; }
  html[data-adapt="tablet"] body { max-width: 768px; margin: 0 auto; padding-left: 8px; padding-right: 8px; }
  html[data-adapt="mobile"] body { max-width: 390px; margin: 0 auto; padding-left: 12px; padding-right: 12px; }
  body { transition: max-width 0.25s ease; }
</style>
<script>
(function(){
  const root = document.documentElement;
  const KEY = 'adapt-mode';
  function detectMode(){ const w = window.innerWidth; if(w < 640) return 'mobile'; if(w < 1024) return 'tablet'; return 'desktop'; }
  function updateLabel(mode){ const label=document.getElementById('adapt-label'); const icon=document.getElementById('adapt-icon'); if(!label||!icon) return; const map={auto:['è‡ªé€‚åº”','ğŸ§­'],desktop:['ç”µè„‘ç«¯','ğŸ’»'],tablet:['å¹³æ¿ç«¯','ğŸ“Ÿ'],mobile:['æ‰‹æœºç«¯','ğŸ“±']}; const p=map[mode]||map.auto; label.textContent=p[0]; icon.textContent=p[1]; }
  function apply(mode){ if(mode==='auto'){ updateLabel('auto'); return; } root.setAttribute('data-adapt',mode); updateLabel(mode); }
  function init(){ const saved=localStorage.getItem(KEY)||'auto'; apply(saved); if(saved==='auto'){ const setByScreen=()=>{ const m=detectMode(); root.setAttribute('data-adapt',m); }; setByScreen(); window.addEventListener('resize',setByScreen); } }
  document.addEventListener('DOMContentLoaded',()=>{ const toggle=document.getElementById('adapt-toggle'); const menu=document.getElementById('adapt-menu'); if(toggle){ toggle.addEventListener('click',()=>menu.classList.toggle('hidden')); document.addEventListener('click',(e)=>{ if(!menu.contains(e.target) && e.target!==toggle){ menu.classList.add('hidden'); } }); }
    ['auto','desktop','tablet','mobile'].forEach(m=>{ const el=document.querySelector('#adapt-menu [data-adapt="'+m+'"]'); if(!el) return; el.addEventListener('click',()=>{ localStorage.setItem(KEY,m); if(m==='auto'){ updateLabel('auto'); const setByScreen=()=>{ const mm=detectMode(); root.setAttribute('data-adapt',mm); }; setByScreen(); window.addEventListener('resize',setByScreen); } else { root.setAttribute('data-adapt',m); updateLabel(m); window.removeEventListener('resize',()=>{}); } menu.classList.add('hidden'); }); });
    init();
  });
})();
</script>

</body>
</html>